mpisize = 1024                
mpirank = 0                   
Time for reading the raw input file is 0.000277188 [s]

Time for reading the input file is 0.14365 [s]

*********************************************************************
Common information
*********************************************************************

Super cell                           = +3.011780962600e+01 +1.288292867100e+02 +2.975184934470e+02 
Grid Wavefunction                    = 88                  384                 1024                
Grid Density                         = 88                  384                 1024                
Mixing dimension                     = 1                   
Mixing variable                      = density             
Mixing DFT type                      = anderson            
Mixing Hybrid DGDFT type             = anderson            
Mixing Steplength                    = +4.000000000000e-01
DG InnerSCF Mixing variable          = density             
DG OuterSCF Mixing variable          = density             
DG DFT OuterSCF Tolerance            = +1.000000000000e-07
DG DFT OuterSCF Energy Tolerance     =+1.000000000000e-06
DG DFT OuterSCF MinIter              = 3                   
DG DFT OuterSCF MaxIter              = 1                   
DG DFT InnerSCF Tolerance            = +1.000000000000e-07
DG DFT InnerSCF MinIter              = 1                   
DG DFT InnerSCF MaxIter              = 1                   
DG Hybrid InnerSCF Tolerance         = +1.000000000000e-06
DG Hybrid InnerSCF MinIter           = 1                   
DG Hybrid InnerSCF MaxIter           = 1                   
DG Hybrid OuterSCF MinIter           = 3                   
DG Hybrid OuterSCF MaxIter           = 2                   
DG Hybrid OuterSCF Tolerance         = +1.000000000000e-06
DG Hybrid OuterSCF Energy Tolerance  =+1.000000000000e-06
DG Hybrid ALBs MaxIter               = 1                   
DG Hybrid ALBs Tolerance             = +1.000000000000e-06
Temperature                          = +3.000000000000e+02[K]   
au2K                                 = +3.157746700000e+05
Tbeta                                = +1.052582233333e+03
Temperature2                          = +3.000000000000e+02[K]   
Extra states                         = 0                   
Smearing scheme                      = FD                  
PeriodTable File                     =                     
Pseudo Type                          = ONCV                
PW Solver                            = LOBPCG              
XC Type                              = XC_HYB_GGA_XC_HSE06 
Hybrid ACE                           = false   
Hybrid DF                            = false   
DGHF ISDF                            = false   
DGHF ISDF Num Mu                     = +1.200000000000e+01
Hybrid Active Init                   = false   
Hybrid Mixing Type                   = nested              
Hybrid DF Num Mu                     = +6.000000000000e+00
Hybrid DF Num GaussianRandom         = +2.000000000000e+00
Hybrid DF Tolerance                  = +1.000000000000e-20
SCF Outer Tol                        = +1.000000000000e-08
SCF Outer MaxIter                    = 30                  
SCF Free Energy Per Atom Tol         = +1.000000000000e-06
Eig Min Tolerence                    = +1.000000000000e-03
Eig Tolerence                        = +1.000000000000e-13
Eig MaxIter                          = 1                   
Eig Tolerance Dyn                    = false   
Num unused state                     = 0                   
EcutWavefunction                     = +4.000000000000e+01
Density GridFactor                   = +1.000000000000e+00
Use Atom Density                     = false   
Use VLocal                           = false   
RestartDensity                       = false   
RestartWfn                           = false   
OutputDensity                        = false   
OutputPotential                      = false   
Number of Extra Electron             = 0                   

*********************************************************************
DGDFT information
*********************************************************************

Penalty Alpha                        = +2.000000000000e+01
Element size                         = 1                   16                  32                  
Wfn Elem GridSize                    = 88                  24                  32                  
Rho Elem GridSize                    = 88                  24                  32                  
LGL Grid size                        = 88                  24                  32                  
LGL GridFactor                       = +1.000000000000e+00
SVD Basis Tol                        = +1.000000000000e-20
SCF Inner Tol                        = +1.000000000000e-04
SCF Inner MaxIter                    = 1                   
Solution Method   = diag                
Number of procs for ScaLAPACK        = 1024                
Number of procs for ScaLAPACK (PW)   = 2                   
ScaLAPACK block                      = 32                  
OutputALBElemLGL                   = false   
OutputALBElemUniform               = false   
OutputWfnExtElem                   = false   
OutputPotExtElem                   = false   
OutputHMatrix                      = false   
Force each step (deprecated)       = false   
A Posteriori error each step       = false   

NumAtom = 4096                
Atom Type and Coordinates (possibly after shifting into unit cell)


UPF version: 2
Time for setting up the periodic table is 0.038521688577 [s]

 number of atoms in extended elements 72
 numStateTotal 128
XC_GGA_XC_PBE  XId_ CId_ = 101 130

XC_HYB_GGA_XC_HSE06  XCId = 428

Number of electrons in extend element        = 288                 
Number of Occupied States                    = 144                 
Computing the local pseudopotential
Sum of Pseudocharge                          = -6.520340966245e+04
Number of Occupied States                    = 144                 
After adjustment, Sum of Pseudocharge        = +2.880000000000e+02
Computing the non-local pseudopotential
Total number of nonlocal pseudopotential = 576                 
Time for nonlocal pseudopotential 0.401718169538
computed exxDiv_ = 0
Hybrid mixing parameter  = 0.25
Hybrid screening length = 0.106
Time for setting up the exchange for the extended Hamiltonian  part = 0.0792874904582 [s]
Time for setting up extended element is 0.0798262771277 [s]

localNz        = 2
localNzStart   = 0
numAllocLocal  = 90112
numGridLocal   = 67584
numGridTotal   = 34603008
 numElem = 1 16 32 
numGridLocal   = 67584
numGridTotal   = 34603008
 numGrid = 88 384 1024 
 numGridElem = 88 24 32 
  localNzStart 0
  localNyStart 0
  init complete 
Time for Fourier grid weight = 
Time for setting up Distributed Fourier is 0.284117226198 [s]
XC_HYB_GGA_XC_HSE06  XCId = 428
XC_HYB_GGA_XC_HSE06  XId = 101
XC_HYB_GGA_XC_HSE06  CId = 130

Number of electrons in extend element        = 16384               
Number of Occupied States                    = 8192                

Prepare the integration weights for constructing the DG matrix.
The number of atom < Rzero = 13

Atomic pseudocharge computed.
Sum of Pseudocharge                          = -3.709349527464e+06
numOccupiedState                             = 8192                
After adjustment, sum of Pseudocharge        = +1.638400000000e+04
 Init new FFT Grid for HFX construction 
 numGridTotalR2CHFX 311040
computed DG exxDiv_ = 0
Hybrid mixing parameter  = 0.25
Hybrid screening length = 0.106
Time for setting up the DG Hamiltonian is 1.21356509381 [s]

Generating initial density through linear combination of pseudocharges.
Initial density. Sum of density      = +1.638400000000e+04
Initial random basis functions in the extended element.
Initial basis functions with random guess.
Time for setting up SCFDG is 6.19403957188 [s]

*********************************************************************
Starting regular DGDFT SCF iteration.
*********************************************************************

XC_GGA_XC_PBE  XId_ CId_ = 101 130
Re-calculate PBE-XC for Hybrid DFT 
input Copy times: 0.000201813818421
forward FFT times: 0.0146831528691
direction: 0 back ik times:0.0063197214331
direction: 0 backward FFT times:0.0158972619101
direction: 1 back ik times:0.00707714477903
direction: 1 backward FFT times:0.0108752895321
direction: 2 back ik times:0.00714022380998
direction: 2 backward FFT times:0.0104110242974
Time for calculating gradient of density is 0.0818993395369 [s]

call libxc for Exc -5080.23977229
Time for calculating XC is 0.0988727109507 [s]

 Time for iterFFT    = 2  timeFFT      = 0.0195867366565
Time for calculating Hartree is 0.023159730481 [s]

Time for calculating Vtot is 0.000503405724885 [s]


*********************************************************************
Outer SCF iteration # 1
*********************************************************************

key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 

Time Comm: 0.0154910442943

Time Loop neighborhood: 0.003163600486

Time Modify: 1.15280854516e-05

Time Inter y: 0.00138493141276

Time Inter: 0.00583012046991
OuterSCF:: Time for updating the local potential in the extended element and the element is 0.0288230209553 [s]

 The current tolerance used by the eigensolver is 1e-13
 The target number of converged eigenvectors is 128


After 1 iterations, LOBPCG did not converge. 
The maximum norm of the residual is 1.05961890667

The minimum norm of the residual is 0.521133930496


 Eigensolver time = 21.3160136057 [s]

ALB calculation in extended element 0 0 0 

 Max residual of basis = +1.059618906668e+00
 Avg residual of basis = +5.271651351002e-01

Time for interpolating basis = 3.18384929001 [s]
Number of significant SVD basis = 128
Time for SVD of basis = 0.343754066678 [s]

Time for generating ALB function is 24.8509057614 [s]


 AlltoallForward: Changing distribution of local basis functions ...  Done. ( 0.0824317962106 s)  InnermixVariable_ density
 mixType_ anderson

Inner SCF iteration #1 starts.

Time for constructing the DG matrix is 2.21070110286 [s]


 Estimating the spectral bounds ... key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 
key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 
key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 
key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 
key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 
key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 

 Ritz values in estimator here : 6
 1.673815316520e+00 6.509520534489e+00 1.536926472055e+01 2.535474807208e+01 3.694465533295e+01 4.315225802829e+01

 Upper bound of spectrum = 5.571750124697e+01
 Done. ( 3.729493427090e-02 s.)
 Initializing eigenvectors randomly on first SCF step ...  Done. ( 2.599172109622e-01 s.)

 ------------------------------- 
 First CheFSI step for DGDFT cycle 1 of 1 . 

 Filtering the eigenvectors ... (Filter order = 1)
 Chebyshev filtering : Process 0 working on 4096 of 8192 bands.
 Chebyshev filtering : Lower bound = 2.241303667241e+01
                     : Upper bound = 5.571750124697e+01
                     : a_L = 1.673815316520e+00key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 

 Total filtering time for 1 filter steps = 9.145882190205e-02 s.
 Average per filter step = 9.145882190205e-02 s.
 Eigenvector block rebuild time = 7.483007619157e-03 s.
 Filtering completed. ( 1.053111723741e-01 s.)

 Solving subspace problems using ScaLAPACK ...
 Setting up BLACS and ScaLAPACK Process Grid ... Done. ( 1.744875713484e-03 s.)
 ScaLAPACK will use 512 processes.
 ScaLAPACK process grid = 32 * 16 .

 Orthonormalization step : 
 Distributed vector to ScaLAPACK format conversion ...  Done. ( 2.807883814385e-01 s.)
 Orthonormalizing filtered vectors ... 
 Overlap matrix computed in : 7.774045838160e-01 s.
 Cholesky factorization computed in : 7.943990056170e+00 s.
 TRSM computed in : 6.142095409450e-01 s.
 Orthonormalization steps completed ( 9.338007921906e+00 s.)

 ScaLAPACK to Distributed vector format conversion ...  Done. ( 1.793087918777e-01 s.)
 Communicating orthonormalized filtered vectors ...  Done. ( 3.532466653269e-04 s.)

 Computing H * X for filtered orthonormal vectors : key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 

 Hamiltonian times eigenvectors calculation time = 9.042257096735e-02 s.
 Eigenvector block rebuild time = 1.136799188680e-02 s.
 H * X for filtered orthonormal vectors computed . ( 1.045447604847e-01 s.)

 Raleigh - Ritz step : 
 Distributed vector to ScaLAPACK format conversion ...  Done. ( 2.777638800035e-01 s.)
 Solving the subspace problem ... 
 X^T(HX) computed in : 8.438221923716e-01 s.
 Eigenvalue problem solved in : 7.572974651906e+00 s.
 Subspace rotation step completed in : 6.098813657009e-01 s.
 All subspace problem steps completed . ( 9.030816919985e+00 s.)

 ScaLAPACK to Distributed vector format conversion ...  Done. ( 1.794336533349e-01 s.)
 Communicating eigenvalues and eigenvectors ...  Done. ( 3.853109374177e-04 s.)
 ------------------------------- 
 This Chebyshev cycle took a total of 1.951751750859e+01 s.
 ------------------------------- 

 Total time for diag DG matrix via Chebyshev filtering is 1.981791615047e+01 [s]

Call for Full DM After DIAG 
InnerSCF: DIAG Time for computing full density matrix 1.981791615047e+01 [s]

InnerSCF: Time for computing harris energy 9.817823884077e-04 [s]


 Using alternate routine for electron density: 

 Forming diagonal blocks of density matrix ...  Done. ( 8.094335236819e-03 s) 

 Sum Rho on LGL grid (raw data) = +8.192000000000e+03
 Sum Rho on uniform grid (interpolated) = +8.195139164567e+03

InnerSCF: Time for computing density 1 in the global domain is 2.32721720857 [s]

norm(MixDif)          = +1.285213746552e+02
norm(MixOld)          = +1.531496438529e+02
norm(out-in)/norm(in) = +8.391882045684e-01
Time for computing the SCF residual is 0.00212475619628 [s]

 anderson density mixing 
InnerSCF: Time for mixing is 0.00213791095302 [s]

Numer of Occupied State 8192                
Rho factor after mixing (raw data) = +9.999999999998e-01
Sum Rho after mixing (raw data)    = +1.638400000000e+04

input Copy times: 0.000200760492589
forward FFT times: 0.010542366188
direction: 0 back ik times:0.00647132855374
direction: 0 backward FFT times:0.0103584642929
direction: 1 back ik times:0.00662272714544
direction: 1 backward FFT times:0.0121005371329
direction: 2 back ik times:0.00678611762123
direction: 2 backward FFT times:0.0106336981116
Time for calculating gradient of density is 0.0729172047577 [s]

call libxc for Exc -4110.91958889
Exc after DIAG -4110.91958889
Time for computing Exc in the global domain is 0.121468261903 [s]

 Time for iterFFT    = 2  timeFFT      = 0.0207806390536
InnerSCF: Time for computing Vhart in the global domain is 0.0242768185853 [s]

InnerSCF: Time for computing KSEnergy in the global domain is 0.00170753095881 [s]


EfreeHarris       = +1.161993109353e+05[au]  
Etot              = +1.158972467096e+05[au]  
Efree             = +1.158972467096e+05[au]  
Ekin              = +1.187473588784e+05[au]  
Ehart             = +5.002144858956e-03[au]  
EVxc              = -5.356812422222e+03[au]  
Exc               = -4.110919588887e+03[au]  
EVdw              = +0.000000000000e+00[au]  
Eself             = +4.096000000000e+03[au]  
EIonSR            = +0.000000000000e+00[au]  
Ecor              = -2.850112168810e+03[au]  
Fermi             = +1.159615775299e+01[au]  
HOMO#            = +3.155475275860e+02[eV]  
Time for this inner SCF iteration = 24.6089453186 [s]
Time for all inner SCF iterations is 24.6110651438 [s]

OUTERSCF: EfreeHarris                 = +1.161993109353e+05
OUTERSCF: Efree                       = +1.158972467096e+05
OUTERSCF: norm(out-in)/norm(in) = +3.356752818274e-01
OUTERSCF: Efree diff per atom   = +7.374614885203e-02

Time for this SCF iteration = 49.6415227028 [s]

Total time for all SCF iterations = 49.6444222986 [s]
Total number of outer SCF steps (SCF not converged) = 1

*********************************************************************
Starting Hybrid DFT SCF iteration.
*********************************************************************

XC_HYB_GGA_XC_HSE06  XCId = 428
XC_HYB_GGA_XC_HSE06  XId_ CId_ = 101 130
Re-calculate XC for Hybrid DFT 
input Copy times: 0.00020138049149
forward FFT times: 0.0098476257117
direction: 0 back ik times:0.00647113335435
direction: 0 backward FFT times:0.0107603866782
direction: 1 back ik times:0.00661319238134
direction: 1 backward FFT times:0.0101914676197
direction: 2 back ik times:0.00678520571091
direction: 2 backward FFT times:0.010255482397
Time for calculating gradient of density is 0.0704815404606 [s]

call libxc for Exc -855.477331175
Time for calculating XC is 0.161675186187 [s]

 Time for iterFFT    = 2  timeFFT      = 0.0198174071556
Time for calculating Hartree is 0.0235162476311 [s]

Time for calculating Vtot is 0.000505040487042 [s]
Init hybrid mixing parameters 

*********************************************************************
Hybrid DFT Outer SCF iteration # 1
*********************************************************************

key 0 0 0 1 
key 1 0 0 31 
key 2 0 1 0 
key 3 0 1 1 
key 4 0 1 31 
key 5 0 15 0 
key 6 0 15 1 
key 7 0 15 31 

Time Comm: 0.0164845362015

Time Loop neighborhood: 0.00315960665466

Time Modify: 1.17128365673e-05

Time Inter y: 0.00136153190397

Time Inter: 0.00589129904984
OuterSCF:: Time for updating the local potential in the extended element and the element is 0.0305568137846 [s]

InnerSCF: Recalculate density matrix for diag method 
The current tolerance used by the eigensolver is 1e-13
The target number of converged eigenvectors is 128

Time for updating Phi related variable is 0.09747294712 [s]
ExtElem Fock energy 1    = -2.247093365842e+00[au]  
Time for computing the EXX energy is 284.416794612 [s]

*********************************************************************
Phi iteration # 1
*********************************************************************


After 1 iterations, LOBPCG did not converge. 
The maximum norm of the residual is 2.76126462383

The minimum norm of the residual is 1.4872834414


Eigensolver time = 566.53117162 [s]
Time for computing occupation rate in PWDFT is 2.75390339084e-05 [s]

Time for updating Phi related variable is 0.0976283462078 [s]

ExtElem Fock energy       = -4.394637528114e+00[au]  
dExx for PWDFT            = +4.886737867534e-01[au]  

ALB calculation in extended element 0 0 0 

Max residual of basis = +2.761264623834e+00
Avg residual of basis = +2.646360379465e+00

Time for interpolating basis = 3.19336443144 [s]
Number of significant SVD basis = 128
Time for SVD of basis = 0.340841380472 [s]

Time for generating ALB function is 1139.08305159 [s]
